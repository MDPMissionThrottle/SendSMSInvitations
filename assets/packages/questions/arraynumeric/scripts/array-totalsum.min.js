function updatetotals(e){console.ls.log(e);var inputValue=$(this).val(),sTableID=(LSvar.sLEMradix,$(this).closest("table").attr("id")),sTable=$(this).closest("table"),iGrandTotal=new Decimal(0);if(normalizeValue(inputValue)){sTable.find("tr").each(function(){var sum=new Decimal(0);$(this).find("input:enabled:visible").each(function(){var value=normalizeValue($(this).val());sum=sum.plus(value)}),$(this).find("input:disabled").val(formatValue(sum)).trigger("change").trigger("keyup").trigger("keydown"),iGrandTotal=iGrandTotal.plus(sum)});for(var iColumnNum=$("#"+sTableID+" tbody tr:first-child input:enabled:visible").length,$iRow=sTable.find("tr"),i=1;i<=iColumnNum;i++){var sum=new Decimal(0);$iRow.each(function(){var item=$($(this).find("td").get(i-1)).find("input:enabled:visible"),val=normalizeValue($(item).val());sum=sum.plus(val)}),$($iRow.last().find("td").get(i-1)).find("input:disabled").val(formatValue(sum)).trigger("change").trigger("keyup").trigger("keydown")}$iRow.last().find("td.grand.total").find("input:disabled").val(formatValue(iGrandTotal)).trigger("change").trigger("keyup").trigger("keydown")}else $(this).val(inputValue.substring(0,inputValue.length-1))}function formatValue(sValue){sValue=Number(sValue).toString();var sRadix=LSvar.sLEMradix;return sValue=sValue.replace(".",sRadix)}function normalizeValue(aValue){if(!new RegExp(/^-?([0-9]*)((,|\.){1}([0-9]*)){0,1}$/).test(aValue)&&bFixNumAuto)return 0;aValue=aValue||0;var outNumber=!1;try{outNumber=new Decimal(aValue)}catch(e){}if(0==outNumber){var numReplaced=aValue.toString().replace(/,/g,".");try{outNumber=new Decimal(numReplaced)}catch(e){}return outNumber}return outNumber}$(document).on("ready pjax:scriptcomplete",function(){$("div.array-multi-flexi-text table.show-totals input:enabled").keyup(updatetotals),$("div.array-multi-flexi-text table.show-totals input:enabled").each(updatetotals)});
